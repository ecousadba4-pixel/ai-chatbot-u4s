<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>U4S Chat Widget</title>

  <script id="u4s-config" type="application/json">
    {
      "fnUrl": "/api/chat"
    }
  </script>

  <!-- Boot: подключаем CSS/JS с версией из ?v=... -->
  <script>
    (function () {
      var v = new URLSearchParams(location.search).get('v') || '';

      function addCSS(href) {
        var l = document.createElement('link');
        l.rel = 'stylesheet';
        l.href = href + (v ? ('?v=' + encodeURIComponent(v)) : '');
        document.head.appendChild(l);
      }

      function addJS(src, defer) {
        var s = document.createElement('script');
        s.src = src + (v ? ('?v=' + encodeURIComponent(v)) : '');
        if (defer) s.defer = true;
        document.head.appendChild(s);
      }

      addCSS('frontend.css');
      addJS('frontend.js', true);
    })();
  </script>
  <noscript>Для работы виджета требуется JavaScript.</noscript>

  <style>
    /* небольшая страховка на время загрузки CSS */
    #u4s-chat { visibility: hidden; }
    html.js-ready #u4s-chat { visibility: visible; }
  </style>
  <script>
    // как только JS загрузится, пометим документ
    (function () {
      document.documentElement.classList.add('js-ready');
    })();
  </script>
</head>
<body>

  <!-- === U4S Chat Widget — Flexbe embed === -->
  <div id="u4s-fab" aria-label="Открыть чат" role="button" tabindex="0">
    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M20 14.5c0 1.9-1.6 3.5-3.5 3.5H9l-5 4V6.5C4 4.6 5.6 3 7.5 3h9C18.4 3 20 4.6 20 6.5v8z" stroke="white" stroke-width="1.6" fill="none"/>
    </svg>
  </div>

  <div id="u4s-chat" aria-live="polite" aria-label="Чат с помощником">
    <div id="u4s-head">
      <div class="u4s-avatar">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
          <circle cx="7" cy="14" r="3"/><circle cx="12" cy="11" r="3"/><circle cx="17" cy="14" r="3"/>
        </svg>
      </div>
      <div class="u4s-head-text">
        <div class="u4s-title">Помощник Усадьбы</div>
        <div class="u4s-sub">Задайте вопрос — отвечу по базе знаний</div>
      </div>
      <button id="u4s-reset" type="button">Начать заново</button>
    </div>

    <div id="u4s-scroll"></div>

    <form id="u4s-inputbar">
      <input id="u4s-q" type="text" placeholder="Напишите сообщение…" autocomplete="off" />
      <button id="u4s-send" type="submit">Отпр.</button>
    </form>
  </div>
  <!-- === /U4S Chat Widget === -->

</body>
</html>
